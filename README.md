# Multi-Modal-and-Multi-Condition-Fault-Diagnosis-of-Rotating-Machinery
《Multi-Modal and Multi-Condition Fault Diagnosis of Rotating Machinery via a Heterogeneous Graph Learning Framework》
Abstract: Intelligent fault diagnosis of rotating machinery under multi-modal and multi-condition scenarios presents critical challenges, including the low utilization of structural information and weak model generalization capability. To address these issues, this paper proposes a Structural Awareness Heterogeneous Graph Transformer (SAHGT) framework to achieve unified modeling and robust representation learning of multi-source monitoring signals. The method constructs a unified heterogeneous graph structure to integrate modal features, frequency-domain relationships, and spatial priors. By introducing a heterogeneous graph Transformer with a dual-guided attention mechanism that combines modality-guided and frequency-guided attention, it enhances the selective expression of key features and the discriminative capability for fault patterns. To enhance the model’s adaptability in non-stationary environments, an augmented view-driven contrastive learning mechanism is designed to further strengthen robustness against structural variations and distribution shifts. Notably, this paper establishes a unified training framework that enables switching between Domain Generalization (DG) and Domain Adaptation (DA) tasks solely by configuring loss function combinations without modifying the model architecture. The validation experiments conducted on a high-fidelity gas turbine test platform demonstrate the superior performance of the proposed SAHGT framework, achieving average fault diagnosis accuracies of 83.46% and 99.57% on nine DG tasks and twelve DA tasks, respectively. These results significantly outperform state-of-the-art graph neural network methods, highlighting the model’s strong cross-domain generalization and domain adaptability.

This model provides the complete implementation code for the Structure-Aware Heterogeneous Graph Transformer (SAHGT) framework developed using PyTorch and PyTorch Geometric. The data that support the findings of this study are openly available in DRYAD at http://datadryad.org/stash/share/hWqUclkVU-ynfebkzv8i-3657YDSu34SIlr29lnCiuQ4.

Environment Configuration Notes, List of Dependencies:
absl-py==1.4.0
altgraph==0.17.4
beautifulsoup4==4.12.2
cachetools==5.3.0
certifi==2022.12.7
cffi==1.16.0
cftime==1.6.3
charset-normalizer==2.1.1
cloudpickle==3.0.0
contourpy==1.0.7
cycler==0.11.0
dill==0.3.7
EMD-signal==1.5.2
et-xmlfile==1.1.0
exceptiongroup==1.2.0
filelock==3.9.0
fonttools==4.39.4
fsspec==2023.4.0
future==0.18.3
gevent==23.9.1
gitdb==4.0.10
GitPython==3.1.31
google-auth==2.18.0
google-auth-oauthlib==1.0.0
graphviz==0.5.1
greenlet==3.0.3
grpcio==1.54.0
huggingface-hub==0.16.4
idna==3.4
importlib-resources==5.12.0
iniconfig==2.0.0
Jinja2==3.1.2
joblib==1.2.0
kiwisolver==1.4.4
labelImg==1.8.6
llvmlite==0.41.1
lxml==4.9.2
Markdown==3.4.3
MarkupSafe==2.1.2
matplotlib==3.7.1
mpmath==1.2.1
multiprocess==0.70.15
netCDF4==1.6.5
networkx==3.0rc1
neupy==0.6.5
nolds==0.5.2
numba==0.58.1
numpy==1.26.3
oauthlib==3.2.2
opencv-python==4.7.0.72
openpyxl==3.1.2
pandas==2.0.1
pathos==0.3.1
patsy==0.5.3
pefile==2023.2.7
Pillow==9.3.0
pluggy==1.3.0
pnn==0.0.5
pox==0.3.3
ppft==1.7.6.7
progressbar2==3.34.3
protobuf==4.23.0
psutil==5.9.5
pyasn1==0.5.0
pyasn1-modules==0.3.0
pycparser==2.21
pyeeg==0.0.2
pyentrp==0.9.0
pyinstaller==6.2.0
pyinstaller-hooks-contrib==2023.10
pyparsing==3.0.9
PyQt5==5.15.9
PyQt5-Qt5==5.15.2
PyQt5-sip==12.12.1
Pysa==0.3b5
pytest==7.4.3
python-utils==3.8.2
pytorch-model-summary==0.1.2
pyts==0.13.0
pytz==2023.3
PyWavelets==1.4.1
PyYAML==6.0
requests==2.28.1
requests-oauthlib==1.3.1
rsa==4.9
safetensors==0.3.1
scikit-learn==1.2.2
scipy==1.10.1
seaborn==0.12.2
sentry-sdk==1.22.2
shap==0.44.1
slicer==0.0.7
smmap==5.0.0
soupsieve==2.5
ssqueezepy==0.6.4
statsmodels==0.14.0
sympy==1.11.1
tableprint==0.7.1
tensorboard==2.13.0
tensorboard-data-server==0.7.0
thop==0.1.1.post2209072238
threadpoolctl==3.1.0
timm==0.9.2
tomli==2.0.1
torch==2.1.1
torch_geometric==2.4.0
tqdm==4.64.1
tslearn==0.6.2
tzdata==2023.3
ultralytics==8.0.98
urllib3==1.26.13
vmdpy==0.2
websocket==0.2.1
websocket-client==1.7.0
Werkzeug==2.3.4
xgboost==2.0.2
xlwt==1.3.0
zope.event==5.0
zope.interface==6.1
